<link rel="import" href="../g-cookies/g-cookies.html">

<polymer-element name="g-app-controller" attributes="cookieName user">
	<template>
		<g-cookies id="cookies"></g-cookies>
		<template if="{{ loggedIn }}">
			<content select="[whenLoggedIn]"></content>
		</template>
		<template if="{{ !loggedIn }}">
			<content select="[whenNotLoggedIn]"></content>
		</template>
	</template>
	<script>
		(function(){
			var _router = null;

			Polymer({
				user: null,

				loggedIn: false,

				login: function(target) {
					this.loggedIn = true;
					_router.init();
					_router.goTo(target);
				},

				logoff: function() {
					this.loggedIn = false;
				},

				ready: function() {
					_router = document.querySelector('g-app-router');
					var username = this.$.cookies.getItem(this.cookieName);
					console.log(this.cookieName, '=', username);
					if(username)
					{
						this.user = {
							username: username
						};
					}
				},
			});

		}());

	</script>
</polymer-element>
